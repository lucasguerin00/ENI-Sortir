{% extends 'base.html.twig' %}

{% block title %}Gestion des utilisateurs{% endblock %}

{% block body %}
    <div class="max-w-7xl mx-auto mt-10 p-6 bg-gray-50 rounded-lg shadow">

        {# --- Formulaire d'import --- #}
        <div class="flex justify-between items-center mb-6">
            <h1 class="text-3xl font-bold text-gray-800">Liste des utilisateurs</h1>

            {{ form_start(form, {'attr': {'class': 'flex items-center gap-4'}}) }}
                {{ form_row(form.csv_file, {'attr': {'class': 'px-4 py-2 border border-gray-300 rounded-md'}}) }}
                <button type="submit"
                        class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition">
                    Importer
                </button>
            {{ form_end(form) }}
        </div>


        {# --- Tableau des utilisateurs --- #}
        <div class="overflow-x-auto shadow-lg rounded-lg">
            <table class="min-w-full divide-y divide-gray-200 bg-white">
                <thead class="bg-gray-100 text-gray-700 uppercase text-sm">
                    <tr>
                        <th class="px-4 py-3 text-left">Pseudo</th>
                        <th class="px-4 py-3 text-left">Nom</th>
                        <th class="px-4 py-3 text-left">Prénom</th>
                        <th class="px-4 py-3 text-left">Mail</th>
                        <th class="px-4 py-3 text-left">Téléphone</th>
                        <th class="px-4 py-3 text-left">Actif</th>
                        <th class="px-4 py-3 text-left">Admin</th>
                        <th class="px-4 py-3 text-center">Action</th>
                    </tr>
                </thead>
                <tbody class="divide-y divide-gray-200 text-sm text-gray-800">
                {% for utilisateur in utilisateurs %}
                    <tr class="hover:bg-gray-50">
                        <td class="px-4 py-2">{{ utilisateur.pseudo }}</td>
                        <td class="px-4 py-2">{{ utilisateur.nom }}</td>
                        <td class="px-4 py-2">{{ utilisateur.prenom }}</td>
                        <td class="px-4 py-2">{{ utilisateur.mail }}</td>
                        <td class="px-4 py-2">{{ utilisateur.telephone }}</td>
                        <td class="px-4 py-2">
                            {% if utilisateur.isactif %}
                                <span class="px-2 py-1 text-green-800 bg-green-100 rounded-full text-xs font-semibold">Oui</span>
                            {% else %}
                                <span class="px-2 py-1 text-red-800 bg-red-100 rounded-full text-xs font-semibold">Non</span>
                            {% endif %}
                        </td>
                        <td class="px-4 py-2">
                            {% if utilisateur.isadministrateur %}
                                <span class="px-2 py-1 text-blue-800 bg-blue-100 rounded-full text-xs font-semibold">Oui</span>
                            {% else %}
                                <span class="px-2 py-1 text-gray-800 bg-gray-100 rounded-full text-xs font-semibold">Non</span>
                            {% endif %}
                        </td>
                        <td class="px-4 py-2 flex flex-col sm:flex-row gap-2">
                            {% if utilisateur.isactif %}
                                <a href="admin/disable/{{ utilisateur.id }}"
                                   class="px-2 py-1 bg-yellow-500 text-white rounded hover:bg-yellow-600 text-xs text-center transitionC w-full">
                                    Désactiver
                                </a>
                            {% else %}
                                <a href="admin/enable/{{ utilisateur.id }}"
                                   class="px-2 py-1 bg-green-600 text-white rounded hover:bg-green-700 text-xs text-center transition w-full">
                                    Activer
                                </a>
                            {% endif %}
                            <a href="admin/del/{{ utilisateur.id }}"
                               class="px-2 py-1 bg-red-600 text-white rounded hover:bg-red-700 text-xs text-center transition w-full">
                                Supprimer
                            </a>
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
{% endblock %}
