{% import '_macros.html.twig' as macros %}

<div class="overflow-x-auto shadow-lg rounded-lg">
    <table class="w-full border-collapse bg-white">
        <thead class="bg-gray-100 text-gray-700 uppercase text-sm">
            <tr>
                <th class="px-4 py-3 text-left">Nom</th>
                <th class="px-4 py-3 text-left">Date du début</th>
                <th class="px-4 py-3 text-left">Cloture</th>
                <th class="px-4 py-3 text-left">Durée (min)</th>
                <th class="px-4 py-3 text-left">Lieu</th>
                <th class="px-4 py-3 text-left">Site</th>
                <th class="px-4 py-3 text-left">Infos</th>
                <th class="px-4 py-3 text-left">Inscriptions</th>
                <th class="px-4 py-3 text-left">État</th>
                <th class="px-4 py-3 text-left">Organisateur</th>
                {% if app.user %}<th class="px-4 py-3 text-center">Actions</th>{% endif %}
            </tr>
        </thead>

        <tbody class="divide-y divide-gray-200 text-sm text-gray-800">
            {% for sortie in sorties %}
                <tr class="hover:bg-gray-100 {% if app.user and sortie.idOrganisateur == app.user %}bg-gray-50{% endif %}">
                    <td class="px-4 py-3">
                        <a href="{{ path('app_sortie_show', {id: sortie.id}) }}" class="text-blue-600 hover:underline">{{ sortie.nom }}</a>
                    </td>
                    <td class="px-4 py-3">
                        {{ sortie.dateHeureDebut ? (sortie.dateHeureDebut|format_datetime(pattern="EEEE d MMMM y 'à' HH'h'mm", locale='fr')|capitalize) : '' }}
                    </td>
                    <td class="px-4 py-3">{{ sortie.dateLimiteInscription ? sortie.dateLimiteInscription|date('d/m/Y') : '' }}</td>
                    <td class="px-4 py-3">{{ sortie.duree }}</td>
                    <td class="px-4 py-3">{{ sortie.idLieu ? sortie.idLieu.nom : '' }}</td>
                    <td class="px-4 py-3">{{ sortie.idSite ? sortie.idSite.nom : '' }}</td>
                    <td class="px-4 py-3">{{ sortie.infosSortie ?: '' }}</td>
                    <td class="px-4 py-3">{{ sortie.participants|length }}/{{ sortie.nbInscriptionMax }}</td>
                    <td class="px-4 py-3">{{ macros.etatBadge(sortie.etat) }}</td>
                    <td class="px-4 py-3">{{ sortie.idOrganisateur ? sortie.idOrganisateur.prenom ~ ' ' ~ sortie.idOrganisateur.nom : '' }}</td>
                    {% if app.user %}
                        <td class="px-4 py-3">
                            {{ include('sortie/partials/_actions-buttons.html.twig') }}
                        </td>
                    {% endif %}
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
